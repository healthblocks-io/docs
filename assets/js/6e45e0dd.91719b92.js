"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[81],{3905:function(e,t,i){i.d(t,{Zo:function(){return d},kt:function(){return g}});var a=i(67294);function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function r(e,t){if(null==e)return{};var i,a,o=function(e,t){if(null==e)return{};var i,a,o={},n=Object.keys(e);for(a=0;a<n.length;a++)i=n[a],t.indexOf(i)>=0||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)i=n[a],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}var c=a.createContext({}),s=function(e){var t=a.useContext(c),i=t;return e&&(i="function"==typeof e?e(t):l(l({},t),e)),i},d=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var i=e.components,o=e.mdxType,n=e.originalType,c=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),p=s(i),g=o,u=p["".concat(c,".").concat(g)]||p[g]||h[g]||n;return i?a.createElement(u,l(l({ref:t},d),{},{components:i})):a.createElement(u,l({ref:t},d))}));function g(e,t){var i=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=i.length,l=new Array(n);l[0]=p;var r={};for(var c in t)hasOwnProperty.call(t,c)&&(r[c]=t[c]);r.originalType=e,r.mdxType="string"==typeof e?e:o,l[1]=r;for(var s=2;s<n;s++)l[s]=i[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,i)}p.displayName="MDXCreateElement"},69324:function(e,t,i){i.r(t),i.d(t,{frontMatter:function(){return r},contentTitle:function(){return c},metadata:function(){return s},toc:function(){return d},default:function(){return p}});var a=i(87462),o=i(63366),n=(i(67294),i(3905)),l=["components"],r={title:"Upgrade SDK"},c=void 0,s={unversionedId:"guides/upgrade",id:"guides/upgrade",isDocsHomePage:!1,title:"Upgrade SDK",description:"Upgrading @healthblocks-io libraries",source:"@site/docs/guides/upgrade.md",sourceDirName:"guides",slug:"/guides/upgrade",permalink:"/docs/guides/upgrade",editUrl:"https://github.com/healthblocks-io/docs/edit/main/docs/guides/upgrade.md",tags:[],version:"current",frontMatter:{title:"Upgrade SDK"},sidebar:"docs",previous:{title:"End-to-end testing with Detox",permalink:"/docs/guides/e2e-testing-with-detox"},next:{title:"@healthblocks-io/core",permalink:"/docs/examples/@healthblocks-io/core"}},d=[{value:"Upgrading @healthblocks-io libraries",id:"upgrading-healthblocks-io-libraries",children:[{value:"Healthblocks versioning",id:"healthblocks-versioning",children:[],level:3},{value:"Release mode",id:"release-mode",children:[],level:3},{value:"Safe upgrade",id:"safe-upgrade",children:[],level:3},{value:"Semi-safe full upgrade",id:"semi-safe-full-upgrade",children:[],level:3},{value:"Dangerous upgrade",id:"dangerous-upgrade",children:[],level:3},{value:"Getting started",id:"getting-started",children:[],level:3},{value:"Upgrade while keeping modifications",id:"upgrade-while-keeping-modifications",children:[],level:3},{value:"Upgrade to latest version while resetting modifications",id:"upgrade-to-latest-version-while-resetting-modifications",children:[],level:3},{value:"Handy commands",id:"handy-commands",children:[],level:3}],level:2}],h={toc:d};function p(e){var t=e.components,i=(0,o.Z)(e,l);return(0,n.kt)("wrapper",(0,a.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"upgrading-healthblocks-io-libraries"},"Upgrading @healthblocks-io libraries"),(0,n.kt)("h3",{id:"healthblocks-versioning"},"Healthblocks versioning"),(0,n.kt)("p",null,"Major versions match with Expo versions."),(0,n.kt)("p",null,"Version 3.x is compatible with Expo 40"),(0,n.kt)("p",null,"Version 4.x is compatible with Expo 41"),(0,n.kt)("h3",{id:"release-mode"},"Release mode"),(0,n.kt)("p",null,"Add the ",(0,n.kt)("inlineCode",{parentName:"p"},".npmrc")," with the authToken."),(0,n.kt)("p",null,"Start with the following dependencies in package.json. The major version numbers should all match."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'"dependencies": {\n  "@healthblocks-io/apollo": "3",\n  "@healthblocks-io/core": "3",\n  "@healthblocks-io/native": "3",\n}\n')),(0,n.kt)("h3",{id:"safe-upgrade"},"Safe upgrade"),(0,n.kt)("p",null,"To safely upgrade, use the upgrade-interactive command and select the @healthblocks-io libraries specifically. This will make changes in ",(0,n.kt)("inlineCode",{parentName:"p"},"yarn.lock")," and not in ",(0,n.kt)("inlineCode",{parentName:"p"},"package.json"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"yarn upgrade-interactive\n")),(0,n.kt)("p",null,"The lockfile dictates what will be installed on your machine, your teammates machines and CI, so new package updates are never automatically applied behind your back."),(0,n.kt)("h3",{id:"semi-safe-full-upgrade"},"Semi-safe full upgrade"),(0,n.kt)("p",null,"If all dependencies are well-defined in your package.json, you can also do a full upgrade. This will safely upgrade all dependencies. As it's harder to know what going on in this case, it can be interesting to review yarn.lock to see which packages were upgraded."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"yarn upgrade\n")),(0,n.kt)("h3",{id:"dangerous-upgrade"},"Dangerous upgrade"),(0,n.kt)("p",null,"Using the \u2014latest flag will ignore the version ranges in package.json. This is useful when upgrading from Expo 40 to Expo 41, but lots of things might change/break. Use ",(0,n.kt)("inlineCode",{parentName:"p"},"expo upgrade")," instead."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"# Not recommended\nyarn upgrade-interactive --latest\n")),(0,n.kt)("h1",{id:"library-development-workspace-mode"},"Library development workspace mode"),(0,n.kt)("h3",{id:"getting-started"},"Getting started"),(0,n.kt)("p",null,"Healthblocks is distributed through Github Packages. The current packages may contain breaking changes regularly. On the other hand, you may want to customize or play around with the components. That's why it may make sense to use the package source instead of the officially released versions. Each package has a corresponding git repo. Start by initializing a git repo for each healthblocks-io/folder. Then you can pull in the latest changes, or switch between branches."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'# Initialize git repos in @healthblocks-io\n[ -d "@healthblocks-io/core" ] && cd @healthblocks-io/core && git init && git checkout expo40 && git remote add origin git@github.com:healthblocks-io/healthblocks-js-core.git && git fetch && git reset --mixed origin/expo40 && cd ../..\n[ ! -d "@healthblocks-io/core" ] && mkdir -p @healthblocks-io/core && cd @healthblocks-io/core && git clone git@github.com:healthblocks-io/healthblocks-js-core.git . && git checkout -b expo40 origin/expo40 && cd ../..\n[ -d "@healthblocks-io/apollo" ] && cd @healthblocks-io/apollo && git init && git checkout expo40 && git remote add origin git@github.com:healthblocks-io/healthblocks-apollo.git && git fetch && git reset --mixed origin/expo40 && cd ../..\n[ ! -d "@healthblocks-io/apollo" ] && mkdir -p @healthblocks-io/apollo && cd @healthblocks-io/apollo && git clone git@github.com:healthblocks-io/healthblocks-apollo.git . && git checkout -b expo40 origin/expo40 && cd ../..\n[ -d "@healthblocks-io/native" ] && cd @healthblocks-io/native && git init && git checkout expo40 && git remote add origin git@github.com:healthblocks-io/healthblocks-js-native.git && git fetch && git reset --mixed origin/expo40 && cd ../..\n[ ! -d "@healthblocks-io/native" ] && mkdir -p @healthblocks-io/native && cd @healthblocks-io/native && git clone git@github.com:healthblocks-io/healthblocks-js-native.git . && git checkout -b expo40 origin/expo40 && cd ../..\n')),(0,n.kt)("p",null,"The commands above will create a ",(0,n.kt)("inlineCode",{parentName:"p"},".git")," but won't affect your working directory.\nLet's see how to upgrade:"),(0,n.kt)("h3",{id:"upgrade-while-keeping-modifications"},"Upgrade while keeping modifications"),(0,n.kt)("p",null,"This is the standard way to upgrade Healthblocks whilst keeping modifications:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-tsx"},"# Pull in changes\ncd @healthblocks-io/core   && git pull --autostash --rebase; cd ../..\ncd @healthblocks-io/apollo && git pull --autostash --rebase; cd ../..\ncd @healthblocks-io/native && git pull --autostash --rebase; cd ../..\n")),(0,n.kt)("h3",{id:"upgrade-to-latest-version-while-resetting-modifications"},"Upgrade to latest version while resetting modifications"),(0,n.kt)("p",null,'By "force upgrading", you will be up-to-date with the latest changes. Make sure to FIRST commit your changes in your app repo. All upgrades will show as changes in your app repo.'),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"# Force upgrade to latest (lose your library customizations)\ncd @healthblocks-io/core && git fetch; git reset --hard origin/expo40;cd ../..\ncd @healthblocks-io/apollo && git fetch; git reset --hard origin/expo40;cd ../..\ncd @healthblocks-io/native && git fetch; git reset --hard origin/expo40;cd ../..\n")),(0,n.kt)("h3",{id:"handy-commands"},"Handy commands"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"# Check for diff\ncd @healthblocks-io/core && git --no-pager diff ;cd ../..\ncd @healthblocks-io/apollo && git --no-pager diff ;cd ../..\ncd @healthblocks-io/native && git --no-pager diff ;cd ../..\n\n# Upgrade to latest\ncd @healthblocks-io/core && git pull;cd ../..\ncd @healthblocks-io/apollo && git pull;cd ../..\ncd @healthblocks-io/native && git pull;cd ../..\n\n# Status\ncd @healthblocks-io/core && git status;cd ../..\ncd @healthblocks-io/apollo && git status;cd ../..\ncd @healthblocks-io/native && git status;cd ../..\n")))}p.isMDXComponent=!0}}]);